{% extends "base.html" %}

{% block header %}

<link type="text/css" href="/site_media/css/editor.css" rel="Stylesheet" />
<script type="text/javascript" src="/site_media/js/editor.js"></script>

        <script type="text/javascript">
	$(function() {

            /* this is temporary here */

           $.booki.username = "{{request.user.username}}";
           $.booki.currentProjectID = {{project.id}};
           $.booki.currentProject = "{{project.name}}";
           $.booki.currentBookID  = {{book.id}};
           $.booki.currentBook    = "{{book.title}}";

	    /* call when page is loaded */

	    $.booki.editor.initEditor();


            $.booki.subscribeToChannel("/booki/", function(message) {

            });


// this should be in editor.js
        $("#formchapter  BUTTON.submit").click(function() {
                  $.booki.ui.notify("Creating chapter");
 
                   $.booki.sendToChannel("/booki/book/"+$.booki.currentProjectID+"/"+$.booki.currentBookID+"/", {"command": "create_chapter", "chapter": $("#formchapter INPUT.chapter").val()}, function(data) {
                           $.booki.ui.notify();
                           $("#formchapter INPUT.chapter").val("");
                      });

          });


          // start Sputnik
          jQuery.booki.network._transport.connect();

	    $("#datepicker").datepicker({"onSelect": function(a) { alert(a)}});

	});

                 </script>


{% endblock %}

{% block content %}
<div id="notify">
some notification. this should be on top of visible page and not top of page.
</div>

<div id="header">
 <div style="float:right; font-size: 12px">
    <a href="/accounts/{{ request.user.username }}/">{{ request.user.username }}</a> | <a href="">Settings</a> | <a href="">Help</a> | <a href="/accounts/signout/">Sign out</a>
 </div>
</div>

<br clear="all"/>

<div>
<div style="float: right; padding-top: 5px">
<form>
<input type="text" size="20"> <button>Search</button>
</form>
</div>
<h1 style="margin-top: 0px"> <a href="/{{ project.url_name }}/{{ book.url_title }}/">{{ book }}</a> </h1>
</div>

<div id="tabs">
	<ul>
		<li><a href="#chapters">Chapters</a></li>
		<li><a href="#settings">People</a></li>
		<li><a href="#bigchat">Chat</a></li>
		<li><a href="#settings">Settings</a></li>

	</ul>
	<div id="chapters">



<table border="0" width="100%">
<tr>
<td valign="top">

<div id="container">
<ul id="chapterslist">
</ul>

<div style="border-bottom: 1px solid #c0c0c0; padding-top: 50px; margin-bottom: 20px"></div>
This is temporary interface. 
<div id="formchapter">
<h2>Create new chapter</h2>
<form method="GET" action="javascript:void(0)" onsubmit="return false">
<input class="chapter" type="text" size="30"><button class="submit">Create chapter</button>
</form>
</div>
<!--
<form action="." method="POST">
<table>
{{ chapter_form.as_table }}
</table>
<br/><br/>
<button>Create</button>
</form>
-->
</div>

<div id="editor" style="display: none">
<form method="GET" action="javascript: return void(0)">
<input type="hidden" name="chapter_id" value=""/>
<input type="button" class="save" name="save" value="Save"/>
<button class="cancel">Cancel</button>
<br/>
<input type="text" name="title" style="width: 500px">
<br/>
<textarea style="width: 500px; height: 400px">
</textarea>
</form>
</div>

</td>
<td valign="top" width="200">
<h4>Chat</h4>
<div id="chat">
</div>

<h4>Active sessions (debug)</h4>
 <div id="users">
 </div>
<!--
                <div id="accordion">
                        <div>                                <h3><a href="#">Info</a></h3>
                                <div>Info about book status and etc.</div>
                        </div>
                        <div>
                                <h3><a href="#">Tools</a></h3>
                                <div>Create new chapter</div>
                        </div>
                        <div>
                                <h3><a href="#">Users</a></h3>
                                <div>Current users...</div>
                        </div>
                </div>
-->

</td>
</tr>
</table>


	</div>
<div id="bigchat">
<table border="0">
<tr>
<td width="100%">
<div id="chat2">
</div>
</td>
<td width="20"></td>
<td valign="top">
<h4>Search conversations</h4>
<form>
<input type="text" style="width:  200px">
</form>
<h4>Conversation history</h4>
<div id="datepicker" ></div>

</td>
</tr>
</table>

</div>
	<div id="settings">
Book settings.
	</div>

</div>



{% endblock %}
