{% extends "base.html" %}

{% load i18n profile %}

{% block header %}
  <title>{% trans "My Books" %}</title>

  <script type="text/javascript" src="{{ request.META.SCRIPT_NAME }}/site_static/js/profile.js"></script>

  <script type="text/javascript">
    $(function() {

	// current browser
	$.booki.username = "{{request.user.username}}";
	
	// profile user should be different variable
	
	$.booki.profileName = "{{user.username}}";

	$.booki.sputnikDispatcherURL = "{% url sputnik.views.dispatcher %}";
	
	/* call when page is loaded */
	
	$.booki.profile.initProfile();
	
	// probably subscribe to /booki/profile/<username>/
	$.booki.subscribeToChannel("/booki/", function(message) {
	    
	});
	
	// start Sputnik
	jQuery.booki.network._transport.connect();
    });

  </script>

{% endblock %}

{% block content %}

<div style="margin-bottom: 5px">

<h2>{% trans "My Books" %}</h2>
<div style="border-bottom: 1px solid #c0c0c0"></div>

<table border="0" cellspacing="2">
{% for book in books %}
  <tr>
   <td>
      <a href="{% url book_view book.url_title %}">
        {% if book.hidden %}
          <i>{{ book.title }}</i>
        {% else %}
          {{ book.title }}
        {% endif %}
      </a>
   </td>
   <td width="50"></td>
   <td><div style="padding-left: 5px; padding-right: 5px"><a href="{% url edit_book  book.url_title %}">{% trans "edit" %}</a></div></td>
   <td><div style="padding-left: 5px; padding-right: 5px"><a href="{% url book_info  book.url_title %}">{% trans "info" %}</a></div></td>
   <td><div style="padding-left: 5px; padding-right: 5px"><a href="{% url draft_book  book.url_title %}">{% trans "draft" %}</a></div></td>
   <td><div style="padding-left: 5px; padding-right: 5px"><a href="{% url view_full  book.url_title %}">{% trans "full" %}</a></div></td>
   <td>
    <div style="white-space: nowrap;">
   {% if user.username == request.user.username %}   
     {% if book.hidden %}
       <form style="display: inline" action="." method="POST">
	 <button>{% trans "Show to others" %}</button>
	 <input type="hidden" name="book" value="{{book.url_title}}" />
	 <input type="hidden" name="action" value="unhide" />
       </form>
     {% else %}
       <form style="display: inline" action="." method="POST">
	 <button>{% trans "Hide from others" %}</button>
	 <input type="hidden" name="book" value="{{book.url_title}}" />
	 <input type="hidden" name="action" value="hide" />
       </form>
     {% endif %}
   {% endif %}
    </div>
   </td>
  </tr>
{% endfor %}
</table>
</div>


{% endblock %}
