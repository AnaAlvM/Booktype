{% load booktype_tags %}

{% if show_header %}
<htmlpageheader name="header-left" style="display:none">
  <div class="header-text" style="text-align: left;">{{ title }}</div>
</htmlpageheader>

<htmlpageheader name="header-right" style="display:none">
  <div class="header-text" style="text-align: right;">{{ title }}</div>
</htmlpageheader>
{% endif %}

{% if show_footer %}
<htmlpagefooter name="footer-left" style="display:none">
  <div class="footer-text" style="text-align: center;">{PAGENO}</div>
</htmlpagefooter>

<htmlpagefooter name="footer-right" style="display:none">
  <div class="footer-text" style="text-align: center;">{PAGENO}</div>
</htmlpagefooter>
{% endif %}

<tocpagebreak links="on" pagenumstyle="1" toc-suppress="1" toc-resetpagenum="1"></tocpagebreak>

{% for item in book_items %}
  {% if item.type == 'chapter' %}
    {% if not forloop.first %}
    <pagebreak />
    {% endif %}
    <sethtmlpageheader name="header-left" page="even" value="on" show-this-page="on" />
    <sethtmlpageheader name="header-right" page="odd" value="on" show-this-page="on" />
    <sethtmlpagefooter name="footer-left" page="even" value="on" />
    <sethtmlpagefooter name="footer-right" page="odd" value="on" />
    <tocentry level="1" content="{{ item.title }}"></tocentry>
    {{ item.content|safe }}
  {% endif %}

  {% if item.type == 'section' %}
    {% if not forloop.first %}
    <pagebreak type="next-odd" />
    {% endif %}
    <sethtmlpageheader page="odd" value="off" />
    <sethtmlpageheader page="even" value="off" />
    <sethtmlpagefooter page="odd" value="off" />
    <sethtmlpagefooter page="even" value="off" />
    <tocentry level="0" content="{{ item.title }}"></tocentry>
    <h1 class="section">{{ item.title }}</h1>
  {% endif %}
{% endfor %}
