{% extends "edit/base.html" %}
{% load i18n staticfiles compress %}

{%  block header %}
    <style>
        #main { padding-top: 200px; margin-left: 50px; margin-right: 50px;}
    </style>
    
    {% include "edit/edit_header.html" %}
    {% include "edit/aloha_header.html" %}

    <script type="text/javascript">  
           window.booktype.username = "{{request.user.username|escapejs}}";
           window.booktype.currentBookID  = {{book.id}};
           window.booktype.currentBook    = "{{book.title|escapejs}}";
           window.booktype.currentBookURL = "{{book.url_title|escapejs}}";

           window.booktype.currentVersion = "{{book_version|escapejs}}";
           window.booktype.sputnikDispatcherURL = "{% url "sputnik.views.dispatcher" %}";
           window.booktype.bookViewUrlTemplate = "{% url "book_view" 'XXX' %}";
           window.booktype.bookDraftViewUrlTemplate = "{% url "draft_book" 'XXX' %}";

           window.booktype.profileThumbnailViewUrlTemplate = "{% url "view_profilethumbnail" 'XXX' %}";

           window.booktype.subscribeToChannel("/booktype/", function(message) {
            });


            Aloha.ready( function() {
                Aloha.require(['jquery', 'aloha', 'booktype'], function(j, aloha, booktype) {
                    booktype.editor.initEditor();    
                    booktype.connect();  
                });
            });
    </script>
    <style>
        div.contentHeader span.info-message { font-size: 12px; margin-right: 10px;}
        .template {
            display: none;
        }

        div.aloha-toolbar {
          display: none !important;
        }
       
       .aloha-editable-highlight {
        outline: 0 !important;
        }
     
       .aloha-editable-active, .aloha-editable-active[contenteditable=true]:focus {
          outline: 0 !important;
        }
    </style>

{% endblock %}

{% block navigation %} 
    <!-- Navbar -->
    <div class="user">
        <div class="btn-group float-right">
            <button class="btn btn-inverse dropdown-toggle" data-toggle="dropdown">{{ request.user.first_name }}<span class="caret"></span></button>
            <ul class="dropdown-menu pull-right">
              <li><a href="{% url "view_profile" request.user.username %}" target="_blank"><i class="icon-user"></i>&nbsp;&nbsp;&nbsp;&nbsp;{% trans "Profile" %}</a></li>
              {% if request.user.is_superuser %}
                 <li><a href="{% url "control_frontpage" %}" target="_blank"><i class="icon-gears"></i>&nbsp;&nbsp;&nbsp;&nbsp;{% trans "Control Center" %}</a></li>
              {% endif %}
              <li class="divider"></li>
              <li><a href="{% url "signout" %}"><i class="icon-signout"></i>&nbsp;&nbsp;&nbsp;&nbsp;{% trans "Logout" %}</a></li>
            </ul>
        </div>
    </div>
    <div class="navbar">
      <div class="logo"><a href="/"></a></div>      
    </div>
    <!-- end Navbar -->

    <!-- Bookbar -->
    <div class="bookbar">
        <h1>{{ book.title }}</h1>
        <div class="btn-toolbar float-right">

          <div class="btn-group">
            <button type="button" class="btn"  rel="tooltip" title="{% trans "Table Of Contents" %}" id="button-toc" data-placement="bottom"><i class="icon-list-alt"></i></button>
            <button type="button" class="btn" rel="tooltip" title="{% trans "Media" %}" id="button-media" data-placement="bottom"><i class="icon-picture"></i></button>        
        <!--    <button type="button" class="btn" rel="tooltip" title="{% trans "Publishing" %}" data-placement="bottom"><i class="icon-print"></i></button> -->
            </div>
        </div>
    </div>
    <!-- end Bookbar -->

    <!-- ToC / Chapter header -->
    <div class="contentHeader">
    </div>
    <!-- end ToC/Chapter header -->
{% endblock %}

{% block content %}

<!-- start of content -->
 <div class="contentContainer">
   <div class="content" id="content">
   </div>
 </div>
<!-- end of content -->

<!-- Tabs content -->
<div class="tablist left-tablist">
    <ul class="navigation-tabs">
<!--        <li><a href="#" id="online-users-tab"><i class="big-icon-online-users"></i></a></li>
        <li><a href="#" id="chat-tab"><i class="big-icon-chat"></i></a></li> -->
    </ul>
</div>    

<div class="tablist right-tablist">
    <ul class="navigation-tabs">        
    </ul>
</div>

<div id="left-tabpane" class="tabpane left-tabpane">
    <section class="tab-content" source_id="chapters-tab">
        <h3>{% trans "Chapters" %}</h3>
        <ul class="edit-toc">
        </ul>
    </section>

    <section class="tab-content hold" source_id="online-users-tab">
      <h3>{% trans "Online users" %}</h3>
    </section>
    <section class="tab-content" source_id="chat-tab">
        <h3>{% trans "Chat" %}</h3>
        <p>some chat here</p>
    </section>
</div>

<div id="right-tabpane" class="tabpane right-tabpane">
    <section class="tab-content hold" source_id="hold-tab">
        <h3>{% trans "Chapters on Hold" %}</h3>
<!--        <div class="ui-draggable" style="position:absolute; z-index: 2000; border: 2px solid red; padding: 10px;">NESTO</div> -->
    </section>
    
    <section class="tab-content" source_id="attachments-tab">
        <h3>{% trans "Attachments" %}</h3>
    </section>
    <section class="tab-content" source_id="notes-tab">
        <h3>{% trans "Notes" %}</h3>
    </section>
    <section class="tab-content" source_id="history-tab">
        <h3>{% trans "History" %}</h3>
    </section>    
</div>
{% endblock %}


<!-- ########################################################################################## -->


{% block misc %}
<!-- Modal windows -->
<div id="newChapter" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">{% trans "Create New Chapter" %}</h3>
  </div>
  <div class="modal-body">
    <input type="text" placeholder="{% trans "Enter new Chapter title" %}">
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">{% trans "Cancel" %}</button>
    <button class="btn btn-primary">{% trans "Create Chapter" %}</button>
  </div>
</div>
<div id="newSection" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">{% trans "Create New Section" %}</h3>
  </div>
  <div class="modal-body">
    <input type="text" placeholder="{% trans "Enter new Section title" %}">
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">{% trans "Cancel" %}</button>
    <button class="btn btn-primary">{% trans "Create Section" %}</button>
  </div>
</div>
<!--
<div id="importChapter" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Clone Chapter</h3>
  </div>
  <div class="modal-body">
    <fieldset>
        <input type="text" placeholder="Enter Book ID">
        <input type="text" placeholder="Enter Chapter ID">
        <input type="text" placeholder="New title (optional)">
    </fieldset>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
    <button class="btn btn-primary">Clone Chapter</button>
  </div>
</div>
-->
<div id="removeChapter" class="modal hide fade">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3>{% trans "Remove chapter" %}</h3>
  </div>
  <div class="modal-body">
    <form>
       <input type="hidden" name="chapter_id" value=""/>
       <p>{% trans "Are you sure you would like to delete this chapter? You will lose all data associated to this chapter and you will not be able to undo this operation!" %}</p>
       <p><input type="checkbox" name="understand" value="on"/> {% trans "I understand and agree" %}</p>
    </form>
  </div>
  <div class="modal-footer">
    <a href="#" class="btn close-button">{% trans "Close" %}</a>
    <button class="btn btn-primary">{% trans "Remove" %}</button>
  </div>
</div>

<li class="item chapter template templateTOCChapter" data-id="">
    <div><i class="toc-icon-chapter"></i>
        <span class="title"></span>
        <div class="toc-chapter-detail">                               
            <div class="username"></div>
            <div class="status"></div>
        </div>
    </div>
    <div class="btn-toolbar">                                          
        <div class="btn-group">
            <button class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="#">{% trans "STATUS" %} <span class="caret"></span></button>
            <ul class="dropdown-menu">
            </ul>
        </div>
        <div class="btn-group">
            <button class="btn btn-mini edit">{% trans "EDIT CHAPTER" %}</button>
            <button class="btn btn-mini dropdown-toggle" data-toggle="dropdown"> <span class="caret"></span></button>
            <ul class="dropdown-menu">
                 <!--
                <li><a href="#">{% trans "View" %}</a></li>
                <li><a href="#">{% trans "Rename" %}</a></li>
                <li><a href="#">{% trans "Hold" %}</a></li>
                -->
                <li><a href="#" class="option-delete">{% trans "Delete" %}</a></li>
            </ul>
        </div>
    </div>
</li>


<li class="item section template templateTOCSection" data-id="">
  <div><span class="disclose"></span><span class="title"></span></div>
  <div class="btn-toolbar">
      <div class="btn-group">
        <button class="btn btn-mini">{% trans "RENAME" %}</button>

      </div>
      <div class="btn-group">
          <button class="btn btn-mini"><i class="icon-trash"></i></button>
      </div>
  </div>
  <ol>
  </ol>
</li> 

<div class="template templateAlohaToolbar">
       {% include "edit/aloha_menu.html" %} 
       {% include "edit/aloha_toolbar.html" %} 
</div>    

<div class="template templateTOCToolbar">
        <h2>{% trans "Table of Contents" %}</h2>
        <div class="btn-toolbar" style="float: right;">
            <button type="button" class="btn" data-toggle="button" id="detail-switch">{% trans "Detail View" %}</button>
            <div class="btn-group">
              <button id="expand" class="btn" rel="tooltip" data-placement="bottom" data-original-title="{% trans "Expand All" %}"><i class="icon-arrow-down"></i></button>
              <button id="collapse" class="btn" rel="tooltip" data-placement="bottom" data-original-title="{% trans "Collapse All" %}"><i class="icon-arrow-up"></i></button>
            </div>
            <div class="btn-group">
              <button href="#newChapter" role="button" class="btn" data-toggle="modal">{% trans "New Chapter" %}</button>
              <button href="#newSection" role="button" class="btn" data-toggle="modal">{% trans "New Section" %}</button>
        <!--      <button href="#importChapter" role="button" class="btn" data-toggle="modal">{% trans "Import Chapter" %}</button> -->
            </div>
        </div>
</div>

<!-- Notifications -->
<div class="notificationContainer">
  <div class="notification">
  </div>
</div>

{% endblock %}
